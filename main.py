#!/usr/bin/env python3
import asyncio
import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from agent import main as agent_main, init_system

async def interactive_chat():
    print("ğŸŒŠ æµ·ä¸Šé£ç”µå·¡æ£€é£é™©è¯„ä¼°ç³»ç»Ÿ")
    print("æ­£åœ¨åˆå§‹åŒ–...")
    
    # å¯åŠ¨æ—¶åˆå§‹åŒ–ç³»ç»Ÿ
    init_system()
    
    print("ç³»ç»Ÿå°±ç»ªï¼è¾“å…¥ 'quit' é€€å‡º")
    print("-" * 60)
    
    # æ˜¾ç¤ºå¸¸ç”¨é—®é¢˜ç¤ºä¾‹
    print("ğŸ’¡ å¸¸ç”¨é—®é¢˜ç¤ºä¾‹ï¼š")
    print()
    print("ğŸš¢ èˆ¹èˆ¶æŸ¥è¯¢ä¸ç›‘æ§ï¼š")
    print("  â€¢ æœç´¢èˆ¹ååŒ…å«'æµ·æ´‹'çš„èˆ¹èˆ¶ä¿¡æ¯")
    print("  â€¢ æŸ¥è¯¢MMSIä¸º440200920çš„èˆ¹èˆ¶è¯¦ç»†ä½ç½®å’ŒçŠ¶æ€")
    print("  â€¢ æŸ¥è¯¢å¤šè‰˜èˆ¹èˆ¶çš„ä½ç½®ä¿¡æ¯ï¼ˆå¦‚MMSI: 440200920, 413859483ï¼‰")
    print("  â€¢ æŸ¥çœ‹MMSIä¸º440200920å‘¨è¾¹10æµ·é‡ŒèŒƒå›´å†…çš„èˆ¹èˆ¶åˆ†å¸ƒ")
    print("  â€¢ æŸ¥è¯¢èˆ¹èˆ¶çš„èˆ¹ç±ä¿¡æ¯å’Œæ¡£æ¡ˆèµ„æ–™")
    print()
    print("âš“ æ¸¯å£ä¿¡æ¯æŸ¥è¯¢ï¼š")
    print("  â€¢ æœç´¢ä¸Šæµ·æ¸¯çš„è¯¦ç»†ä¿¡æ¯å’Œäº”ä½ç ")
    print("  â€¢ æŸ¥è¯¢å®æ³¢æ¸¯çš„åŸºæœ¬ä¿¡æ¯")
    print("  â€¢ æœç´¢'é’å²›'ç›¸å…³çš„æ¸¯å£ä¿¡æ¯")
    print()
    print("ğŸ›£ï¸ èˆªçº¿è§„åˆ’ï¼š")
    print("  â€¢ è§„åˆ’ä»åæ ‡(121.5,31.2)åˆ°(120.2,30.3)çš„æœ€ä¼˜èˆªçº¿")
    print("  â€¢ è®¡ç®—ä¸¤ä¸ªGPSåæ ‡ç‚¹ä¹‹é—´çš„èˆªè¡Œè·ç¦»å’Œè·¯å¾„")
    print()
    print("ğŸŒŠ æµ·æ´‹ç¯å¢ƒè¯„ä¼°ï¼š")
    print("  â€¢ è·å–åŒ—çº¬31.2åº¦ï¼Œä¸œç»121.5åº¦çš„æµ·æ´‹å¤©æ°”æƒ…å†µ")
    print("  â€¢ æŸ¥è¯¢é•¿æ±Ÿå£æµ·åŸŸçš„æµ·å†µé¢„æŠ¥")
    print("  â€¢ åˆ†ææ˜å¤©çš„æµ·å†µæ˜¯å¦é€‚åˆæµ·ä¸Šä½œä¸š")
    print()
    print("ğŸŒ¤ï¸ å¤©æ°”é¢„æŠ¥åˆ†æï¼š")
    print("  â€¢ æŸ¥è¯¢ä¸Šæµ·åœ°åŒºæœªæ¥3å¤©çš„å¤©æ°”é¢„æŠ¥")
    print("  â€¢ è·å–é•¿æ±Ÿå£æµ·åŸŸçš„é£é€Ÿé£å‘ä¿¡æ¯")
    print("  â€¢ åˆ†æå½“å‰å¤©æ°”æ¡ä»¶å¯¹å·¡æ£€ä½œä¸šçš„å½±å“")
    print()
    print("ğŸ“– è§„èŒƒæ ‡å‡†æŸ¥è¯¢ï¼š")
    print("  â€¢ æ ¹æ®NB/T 11768-2025æ ‡å‡†ï¼Œæµ·ä¸Šé£ç”µå·¡æ£€çš„å®‰å…¨è¦æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ")
    print("  â€¢ æŸ¥è¯¢æµ·ä¸Šé£ç”µå·¡æ£€ä½œä¸šçš„å¤©æ°”æ¡ä»¶é™åˆ¶æ ‡å‡†")
    print("  â€¢ NB/T 11768-2025æ ‡å‡†ä¸­å…³äºèˆ¹èˆ¶äº¤é€šå®‰å…¨è·ç¦»çš„è§„å®š")
    print("  â€¢ æµ·ä¸Šé£ç”µåœºå·¡æ£€ä½œä¸šçš„äººå‘˜å®‰å…¨é˜²æŠ¤è¦æ±‚")
    print()
    print("ğŸ“‹ ç»¼åˆé£é™©è¯„ä¼°ï¼š")
    print("  â€¢ æˆ‘éœ€è¦å¯¹ä½äºåŒ—çº¬32.5åº¦ï¼Œä¸œç»120.8åº¦çš„æµ·ä¸Šé£ç”µåœºè¿›è¡Œå·¡æ£€é£é™©è¯„ä¼°")
    print("  â€¢ åˆ†ææ˜å¤©ä¸Šåˆ10ç‚¹åœ¨é•¿æ±Ÿå£è¿›è¡Œæµ·ä¸Šé£ç”µå·¡æ£€çš„å®‰å…¨æ€§")
    print("  â€¢ æ ¹æ®NB/T 11768-2025æ ‡å‡†è¯„ä¼°å½“å‰æµ·å†µæ˜¯å¦é€‚åˆå·¡æ£€ä½œä¸š")
    print("  â€¢ ç»¼åˆåˆ†æå½“å‰å¤©æ°”ã€æµ·å†µã€èˆ¹èˆ¶äº¤é€šå¯¹å·¡æ£€ä½œä¸šçš„å½±å“")
    print()
    print("-" * 60)
    
    while True:
        try:
            user_input = input("\nè¯·è¾“å…¥é—®é¢˜: ").strip()
            
            if user_input.lower() in ['quit', 'exit', 'é€€å‡º']:
                print("å†è§ï¼")
                break
                
            if not user_input:
                continue
                
            await agent_main(user_input, None)
            
        except KeyboardInterrupt:
            print("\nå†è§ï¼")
            break
        except Exception as e:
            print(f"é”™è¯¯: {e}")

if __name__ == "__main__":
    asyncio.run(interactive_chat())
